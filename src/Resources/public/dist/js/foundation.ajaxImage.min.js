"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();!function(e,t){var i=function(){function i(t,n){_classCallCheck(this,i),this.$element=t,this.options=e.extend({},i.defaults,this.$element.data(),n),this._init(),Foundation.registerPlugin(this,"AjaxImage")}return _createClass(i,[{key:"_init",value:function(){this.$fileInput=e(t.render('<input type="file" accept="{{ filemime }}">',{filemime:this.options.accept})),this.$preview=e(t.render('<a><img src="{{ defaultImage }}"><div class="loading-spinner"></div></a>',{defaultImage:this.options.defaultImage})),this.$input.wrap('<div class="ajax-image-container"></div>').after(this.$fileInput).after(this.$preview),this.$preview.on("click",this._trigger.bind(this)),this.$fileInput.on("change",this.upload.bind(this)),this.$loader=this.$preview.find(".loading-spinner"),this.$loader.spin(this.options.spinner)}},{key:"_trigger",value:function(e){e.preventDefault(),this.$fileInput.trigger("click")}},{key:"upload",value:function(){var t=new FormData;t.append("file",this.$fileInput[0].files[0]),Foundation.Motion.animateIn(this.$loader,"fade-in"),e.ajax({type:"post",url:this.options.uploadUrl,contentType:!1,processData:!1,dataType:"json",data:t,complete:this.onUploadComplete.bind(this)})}},{key:"onUploadComplete",value:function(e){var t=e.responseJSON.file;this.$input.val(t),this.$preview.find("img").prop("src",t),Foundation.Motion.animateOut(this.$loader,"fade-out")}}],[{key:"defaults",get:function(){return{accept:"image/*",defaultImage:"",uploadUrl:"",spinner:{lines:9,length:12,width:8,radius:16,scale:1,corners:1,color:"#fff",opacity:.1,rotate:0,direction:1,speed:1,trail:60,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!0,hwaccel:!0,position:"absolute"}}}}]),i}();Foundation.plugin(i,"AjaxImage")}(jQuery,Mustache);